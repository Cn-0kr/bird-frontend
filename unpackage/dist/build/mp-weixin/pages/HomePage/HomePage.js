"use strict";const e=require("../../common/vendor.js");Math||(i+a)();const a=()=>"../../components/tabbar.js",i=()=>"../../components/EnhancedPoster.js",t={__name:"HomePage",setup(a){const i=e.ref(""),t=e.ref(!1),s=e.ref(!0),o=e.ref([]),r=e.ref([]),n=e.ref([]),l=e.ref(0),c="https://birdfront-oss.oss-cn-shanghai.aliyuncs.com",u=(e,a="icon")=>{if(!e)return"";const i=e.startsWith("/")?e.slice(1):e;let t="";switch(a){case"icon":default:t="?x-oss-process=image/resize,m_lfit,w_48,h_48/quality,q_90";break;case"small-icon":t="?x-oss-process=image/resize,m_lfit,w_32,h_32/quality,q_90";break;case"avatar":t="?x-oss-process=image/resize,m_lfit,w_80,h_80/quality,q_90";break;case"large":t="?x-oss-process=image/resize,m_lfit,w_120,h_120/quality,q_90";break;case"medium":t="?x-oss-process=image/resize,m_lfit,w_200,h_200/quality,q_85";break;case"banner":t="?x-oss-process=image/resize,m_lfit,w_750,h_400/quality,q_85";break;case"post":t="?x-oss-process=image/resize,m_lfit,w_400,h_600/quality,q_85";break;case"post-thumb":t="?x-oss-process=image/resize,m_lfit,w_300,h_450/quality,q_80"}return`${c}/${i}${t}`},g=e.ref([{imageUrl:"static/banner/toucan-banner.jpg",title:"发现自然之美",subtitle:"记录每一次与鸟类的美妙邂逅"},{imageUrl:"static/banner/eagle-banner.jpg",title:"翱翔天际",subtitle:"见证猛禽的威武与优雅"},{imageUrl:"static/banner/peacock-banner.jpg",title:"绚烂羽翼",subtitle:"感受大自然的色彩魅力"},{imageUrl:"static/banner/hummingbird-banner.jpg",title:"精灵悬停",subtitle:"捕捉蜂鸟的瞬间之美"}]),m=[{id:1,imageUrl:"static/posts/bird1.jpg",imageHeight:200,description:"今天在公园拍到的小鸟，真的太可爱了！",views:1223,likes:12,author:{name:"鸟类爱好者",avatar:"static/avatars/user1.png"},location:"北京·朝阳公园",publishTime:"2小时前"},{id:2,imageUrl:"static/posts/bird2.jpg",imageHeight:280,description:"清晨6点，记录到了珍贵的候鸟迁徙场景",views:25678,likes:1892,author:{name:"自然摄影师",avatar:"static/avatars/user2.png"},location:"上海·世纪公园",publishTime:"5小时前"},{id:3,imageUrl:"static/posts/bird3.jpg",imageHeight:220,description:"蜂鸟悬停采蜜的瞬间，大自然的精灵",views:5432,likes:234,author:{name:"野生动物保护者",avatar:"static/avatars/user3.png"},location:"云南·西双版纳",publishTime:"1天前"},{id:4,imageUrl:"static/posts/bird4.jpg",imageHeight:300,description:"金刚鹦鹉的绚烂色彩，热带雨林的瑰宝",views:8765,likes:456,author:{name:"生态研究员",avatar:"static/avatars/user4.jpg"},location:"海南·亚龙湾",publishTime:"2天前"}],p=e=>{l.value=e.detail.current,console.log("当前Banner索引:",l.value)},d=()=>{console.log("搜索内容:",i.value),i.value.trim()?q(i.value):y()},v=()=>{t.value=!0},h=()=>{t.value=!1},b=()=>{i.value.trim()&&(q(i.value),e.index.vibrateShort())},_=()=>{console.log("Banner加载完成")},f=a=>{const i=o.value.find((e=>e.id===a.id));i&&(i.likes+=1,x(),e.index.showToast({title:"点赞成功",icon:"success",duration:1e3}))},w=a=>{const i=o.value.find((e=>e.id===a.id));i&&(i.views+=1),e.index.navigateTo({url:`/pages/PosterDetail/PosterDetail?id=${a.id}`})},q=async a=>{try{s.value=!0,await new Promise((e=>setTimeout(e,500)));const e=m.filter((e=>e.description.includes(a)||e.location.includes(a)));o.value=e,x()}catch(i){console.error("搜索失败:",i),e.index.showToast({title:"搜索失败，请重试",icon:"error"})}finally{s.value=!1}},y=()=>{o.value=[...m],x()},x=()=>{r.value=[],n.value=[];let e=0,a=0;o.value.forEach((i=>{const t=i.imageHeight+120;e<=a?(r.value.push(i),e+=t):(n.value.push(i),a+=t)}))},k=e=>{console.warn("图标加载失败:",e)},j=e=>{console.warn("图片加载失败:",e)};return e.onMounted((async()=>{try{await new Promise((e=>setTimeout(e,800)));const e=m.map((e=>({...e,imageUrl:u(e.imageUrl,"post-thumb"),author:{...e.author,avatar:u(e.author.avatar,"avatar")}})));o.value=e,x()}catch(a){console.error("页面初始化失败:",a),e.index.showToast({title:"加载失败，请重试",icon:"error"})}finally{s.value=!1}})),(a,l)=>e.e({a:e.f(g.value,((a,i,t)=>({a:u(a.imageUrl,"banner"),b:e.o(_,i),c:e.o(j,i),d:e.t(a.title),e:e.t(a.subtitle),f:i}))),b:e.o(p),c:u("static/icons/search.png","icon"),d:e.o(k),e:e.o([e=>i.value=e.detail.value,d]),f:e.o(v),g:e.o(h),h:i.value,i:u("static/icons/search-white.png","icon"),j:e.o(k),k:e.o(b),l:t.value?1:"",m:u("static/icons/ranking.png","icon"),n:e.o(k),o:u("static/icons/guide.png","icon"),p:e.o(k),q:u("static/icons/encyclopedia.png","icon"),r:e.o(k),s:u("static/icons/ai-chat.png","icon"),t:e.o(k),v:s.value},s.value?{}:{w:e.f(r.value,((a,i,t)=>({a:e.o(f,a.id),b:e.o(w,a.id),c:"f63a2bd8-0-"+t,d:e.p({"poster-data":a}),e:a.id,f:.1*i+"s"}))),x:e.f(n.value,((a,i,t)=>({a:e.o(f,a.id),b:e.o(w,a.id),c:"f63a2bd8-1-"+t,d:e.p({"poster-data":a}),e:a.id,f:.1*(i+1)+"s"})))},{y:!s.value&&0===o.value.length},s.value||0!==o.value.length?{}:{z:u("static/icons/empty-bird.png","large"),A:e.o(k)})}},s=e._export_sfc(t,[["__scopeId","data-v-f63a2bd8"]]);wx.createPage(s);
