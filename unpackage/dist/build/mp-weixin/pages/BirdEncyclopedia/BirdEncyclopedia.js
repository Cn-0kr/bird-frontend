"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js");Math||t();const t=()=>"../../components/BirdKnowledgeCard.js",l={__name:"BirdEncyclopedia",setup(t){const l=e.ref("search"),i=e.ref(""),u=e.ref(!1),s=e.ref([]),n=e.ref(0),v=e.ref([]),r=e.ref(!1),c=e.ref(0),o=e.ref(0),d=e.ref(0),h=e.ref(1),m=e.ref(1),p=e.ref(.95),g=e.ref(.7),f=[{id:1,name:"巨嘴鸟",scientificName:"Ramphastos sulfuratus",imageUrl:"/static/birds/toucan.jpg",tags:["热带鸟类","彩色","大型"],habitat:"热带雨林",size:"体长50-65cm",weight:"500-860克",wingspan:"109-152cm",diet:"主要以果实为食，偶尔捕食小型动物",behavior:"群居性鸟类，善于飞行和攀爬",distribution:"中美洲和南美洲的热带雨林",conservationStatus:"无危",characteristics:["拥有巨大而彩色的喙","羽毛色彩鲜艳","飞行能力强","社交性强"],funFacts:["巨嘴鸟的大喙实际上很轻，内部充满了气囊","它们的喙可以占到身体长度的1/3","巨嘴鸟睡觉时会将喙折叠到背上"],callDescription:"发出低沉的咕咕声和尖锐的叫声",nestingHabits:"在树洞中筑巢，每次产卵2-4枚",lifespan:"野外约15-20年"},{id:2,name:"蜂鸟",scientificName:"Trochilidae",imageUrl:"/static/birds/hummingbird.jpg",tags:["小型鸟类","快速","悬停"],habitat:"花园、森林边缘",size:"体长5-25cm",weight:"2-20克",wingspan:"5-25cm",diet:"花蜜、小昆虫",behavior:"能够悬停飞行，翅膀拍打频率极高",distribution:"南北美洲",conservationStatus:"大多数种类稳定",characteristics:["世界上最小的鸟类","能够悬停和倒飞","心跳频率极快","新陈代谢旺盛"],funFacts:["蜂鸟的翅膀每秒可拍打80次","它们的心跳每分钟可达1260次","蜂鸟可以倒着飞行","它们的舌头比喙还要长"],callDescription:"发出细小的吱吱声",nestingHabits:"建造精巧的杯状巢，每次产卵1-3枚",lifespan:"野外约3-5年"},{id:3,name:"孔雀",scientificName:"Pavo cristatus",imageUrl:"/static/birds/peacock.jpg",tags:["大型鸟类","华丽","地栖"],habitat:"森林、公园、农田",size:"体长100-115cm",weight:"4-6公斤",wingspan:"120-160cm",diet:"种子、昆虫、小型爬行动物",behavior:"雄鸟会展开尾羽进行求偶炫耀",distribution:"南亚、东南亚",conservationStatus:"无危",characteristics:["雄鸟有华丽的尾羽","能够短距离飞行","叫声洪亮","具有强烈的领域性"],funFacts:["孔雀的尾羽可以长达1.5米",'尾羽上的眼斑叫做"眼状斑"',"孔雀实际上可以飞行，但不擅长长距离飞行",'雌孔雀被称为"孔雀雌"'],callDescription:"发出尖锐的叫声，特别是在求偶季节",nestingHabits:"在地面筑巢，每次产卵3-5枚",lifespan:"野外约15-20年"},{id:4,name:"老鹰",scientificName:"Aquila chrysaetos",imageUrl:"/static/birds/eagle.jpg",tags:["猛禽","大型","捕食者"],habitat:"山地、草原、森林",size:"体长75-100cm",weight:"3-7公斤",wingspan:"180-280cm",diet:"小型哺乳动物、鸟类、鱼类",behavior:"优秀的猎手，视力极佳",distribution:"全球各大洲（除南极洲）",conservationStatus:"部分种类濒危",characteristics:["视力是人类的8倍","强有力的爪子和喙","飞行能力极强","领域性强"],funFacts:["老鹰可以从3公里外发现猎物","它们的俯冲速度可达每小时300公里","老鹰可以活到30岁以上","许多文化将老鹰视为力量和自由的象征"],callDescription:"发出尖锐的啸叫声",nestingHabits:"在高处筑大型巢穴，每次产卵1-3枚",lifespan:"野外约20-30年"}],b=e.computed((()=>{const e=parseInt(n.value)||0,a=parseInt(v.value.length)||0;return 0===a?0:Math.max(0,Math.min(e,a-1))})),_=e.computed((()=>parseInt(v.value.length)||0)),w=e.computed((()=>b.value+1)),I=e.computed((()=>b.value>0&&!r.value&&_.value>0)),x=e.computed((()=>b.value<_.value-1&&!r.value&&_.value>0)),M=e.computed((()=>({transform:`translateY(${d.value}px) scale(${m.value})`,opacity:h.value,zIndex:10}))),y=e.computed((()=>({transform:`scale(${p.value})`,opacity:g.value,zIndex:5}))),$=e=>{r.value||(c.value=e.touches[0].clientY,o.value=e.touches[0].clientY)},j=e=>{if(r.value||0===v.value.length)return;o.value=e.touches[0].clientY;const a=o.value-c.value,t=parseInt(n.value)||0,l=parseInt(v.value.length)||0;if(a<0&&t<l-1){const e=Math.min(Math.abs(a)/200,1);d.value=a,h.value=1-.7*e,m.value=1-.1*e,p.value=.95+.05*e,g.value=.7+.3*e}},S=e=>{if(r.value||0===v.value.length)return;o.value-c.value<-100&&n.value<v.value.length-1?F():T()},T=()=>{d.value=0,h.value=1,m.value=1,p.value=.95,g.value=.7},z=()=>{e.index.navigateBack()},N=()=>{l.value="search"===l.value?"general":"search",e.index.vibrateShort(),"general"===l.value&&0===v.value.length&&q()},B=()=>{i.value.trim()?k():s.value=[]},C=()=>{i.value.trim()&&k()},U=()=>{i.value="",s.value=[]},D=()=>{const e=parseInt(n.value)||0,a=parseInt(v.value.length)||0;e>0&&!r.value&&a>0&&(r.value=!0,d.value=50,h.value=0,setTimeout((()=>{const a=Math.max(0,e-1);n.value=a,T(),r.value=!1}),300))},F=()=>{const a=parseInt(n.value)||0,t=parseInt(v.value.length)||0;a<t-1&&!r.value&&t>0&&(r.value=!0,d.value=-200,h.value=0,m.value=.8,setTimeout((()=>{const e=Math.min(t-1,a+1);n.value=e,T(),r.value=!1}),300),e.index.vibrateShort())},H=a=>{e.index.showToast({title:"已收藏",icon:"success"})},P=a=>{e.index.showShareMenu({title:`分享鸟类：${a.name}`,path:`/pages/BirdEncyclopedia/BirdEncyclopedia?birdId=${a.id}`})},k=async()=>{try{u.value=!0,await new Promise((e=>setTimeout(e,300)));const e=i.value.toLowerCase(),a=f.filter((a=>a.name.toLowerCase().includes(e)||a.scientificName.toLowerCase().includes(e)||a.tags.some((a=>a.includes(e)))||a.habitat.includes(e)));s.value=a}catch(a){console.error("搜索失败:",a),e.index.showToast({title:"搜索失败",icon:"error"})}finally{u.value=!1}},q=()=>{v.value=[...f],n.value=0,T()},E=async()=>{try{v.value=[...f]}catch(a){console.error("加载数据失败:",a),e.index.showToast({title:"加载失败",icon:"error"})}};return e.watch([v,n],(([e,a])=>{const t=parseInt(e.length)||0,l=parseInt(a)||0;if(t>0){const e=Math.max(0,Math.min(l,t-1));e!==l&&(n.value=e)}else n.value=0}),{deep:!0}),e.onMounted((async()=>{const e=getCurrentPages(),a=e[e.length-1].options||{};if(a.birdId){l.value="general",await E();const e=parseInt(a.birdId),t=v.value.findIndex((a=>a.id===e));-1!==t&&(n.value=Math.max(0,Math.min(t,v.value.length-1)))}else await E();T(),v.value.length>0&&(n.value=Math.max(0,Math.min(n.value,v.value.length-1)))})),(t,c)=>e.e({a:a._imports_0$1,b:e.o(z),c:"search"===l.value?"/static/icons/book.png":"/static/icons/search.png",d:e.o(N),e:"general"===l.value?1:"",f:"search"===l.value},"search"===l.value?e.e({g:a._imports_1,h:e.o([e=>i.value=e.detail.value,B]),i:e.o(C),j:i.value,k:i.value},i.value?{l:a._imports_2$3,m:e.o(U)}:{},{n:u.value},u.value?{}:s.value.length>0?{p:e.f(s.value,((a,t,u)=>({a:a.imageUrl,b:e.t(a.name),c:e.t(a.scientificName),d:e.f(a.tags,((a,t,l)=>({a:e.t(a),b:a}))),e:a.id,f:e.o((e=>(e=>{l.value="general";const a=v.value.findIndex((a=>a.id===e.id));-1!==a&&(n.value=parseInt(a)),i.value="",s.value=[],T()})(a)),a.id),g:.1*t+"s"})))}:i.value&&!u.value?{r:a._imports_3$3}:{s:a._imports_4$3},{o:s.value.length>0,q:i.value&&!u.value}):e.e({t:e.t(w.value),v:e.t(_.value),w:(_.value>0?w.value/_.value*100:0)+"%",x:b.value<_.value-1&&_.value>1},b.value<_.value-1&&_.value>1?{y:e.o(H),z:e.o(P),A:e.p({"bird-data":v.value[b.value+1],"is-active":!1}),B:e.s(y.value)}:{},{C:_.value>0&&v.value[b.value]},_.value>0&&v.value[b.value]?{D:e.o(H),E:e.o(P),F:e.p({"bird-data":v.value[b.value],"is-active":!0}),G:e.s(M.value),H:r.value?1:""}:{},{I:e.o($),J:e.o(j),K:e.o(S),L:a._imports_5$3,M:a._imports_6$3,N:r.value?1:"",O:a._imports_7$2,P:I.value?"":1,Q:e.o(D),R:e.t(w.value),S:e.t(_.value),T:a._imports_8$1,U:x.value?"":1,V:e.o(F)}))}},i=e._export_sfc(l,[["__scopeId","data-v-5778ba1f"]]);wx.createPage(i);
