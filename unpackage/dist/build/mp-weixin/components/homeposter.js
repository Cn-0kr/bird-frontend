"use strict";const e=require("../common/vendor.js"),a={name:"HomePoster",props:{posterData:{type:Object,required:!0,default:()=>({id:"",imageUrl:"",imageHeight:200,description:"",views:0,likes:0,accuracy:"",date:""})}},data:()=>({imageLoading:!0,imageError:!1,ossConfig:{baseUrl:"https://birdfront-oss.oss-cn-shanghai.aliyuncs.com"}}),computed:{imageUrl(){return this.getOSSUrl(this.posterData.imageUrl||this.posterData.src,"medium")}},methods:{getOSSUrl(e,a="medium"){if(!e)return`${this.ossConfig.baseUrl}/static/placeholder.png?x-oss-process=image/resize,m_lfit,w_300,h_300/quality,q_70`;const t=e.startsWith("/")?e.slice(1):e;let s="";switch(a){case"thumbnail":s="?x-oss-process=image/resize,m_lfit,w_150,h_150/quality,q_85";break;case"small":s="?x-oss-process=image/resize,m_lfit,w_300,h_300/quality,q_85";break;case"medium":default:s="?x-oss-process=image/resize,m_lfit,w_600,h_600/quality,q_80";break;case"large":s="?x-oss-process=image/resize,m_lfit,w_1200,h_1200/quality,q_85"}const i=`${this.ossConfig.baseUrl}/${t}${s}`;return console.log("HomePoster getOSSUrl:",{originalFilename:e,cleanFilename:t,size:a,params:s,fullUrl:i}),i},handleImageLoad(){this.imageLoading=!1,this.imageError=!1},handleImageError(){this.imageLoading=!1,this.imageError=!0,console.warn("图片加载失败:",this.posterData.imageUrl)},handleItemClick(){this.$emit("item-click",this.posterData),this.posterData.id&&e.index.navigateTo({url:`/pages/detail/detail?id=${this.posterData.id}`})},formatNumber:e=>e?e>=1e4?(e/1e4).toFixed(1)+"w":e>=1e3?(e/1e3).toFixed(1)+"k":e.toString():"0"}};const t=e._export_sfc(a,[["render",function(a,t,s,i,r,o){return e.e({a:o.imageUrl,b:s.posterData.imageHeight+"px",c:e.o(((...e)=>o.handleImageError&&o.handleImageError(...e))),d:e.o(((...e)=>o.handleImageLoad&&o.handleImageLoad(...e))),e:r.imageLoading},(r.imageLoading,{}),{f:e.t(s.posterData.description),g:s.posterData.views},s.posterData.views?{h:e.t(o.formatNumber(s.posterData.views))}:{},{i:s.posterData.likes},s.posterData.likes?{j:e.t(o.formatNumber(s.posterData.likes))}:{},{k:s.posterData.accuracy},s.posterData.accuracy?{l:e.t(s.posterData.accuracy)}:{},{m:s.posterData.date},s.posterData.date?{n:e.t(s.posterData.date)}:{},{o:e.o(((...e)=>o.handleItemClick&&o.handleItemClick(...e)))})}],["__scopeId","data-v-97e4ac6b"]]);wx.createComponent(t);
