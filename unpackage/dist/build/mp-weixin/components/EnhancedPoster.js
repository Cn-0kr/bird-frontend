"use strict";const e=require("../common/vendor.js"),t={__name:"EnhancedPoster",props:{posterData:{type:Object,required:!0,default:()=>({id:"",imageUrl:"",imageHeight:200,description:"",views:0,likes:0,author:{name:"",avatar:""},location:"",publishTime:""})}},emits:["like","view","share"],setup(t,{emit:a}){const s=t,o=a,i=e.ref(!0),r=e.ref(!1),u=e.ref(!1),l=e.ref(!1),c=e.ref(!1),n="https://birdfront-oss.oss-cn-shanghai.aliyuncs.com",p=(e,t="medium")=>{if(!e)return"";const a=e.startsWith("/")?e.slice(1):e;let s="";switch(t){case"icon":s="?x-oss-process=image/resize,m_lfit,w_48,h_48/quality,q_90";break;case"avatar":s="?x-oss-process=image/resize,m_lfit,w_120,h_120/quality,q_90";break;case"small":s="?x-oss-process=image/resize,m_lfit,w_300,h_300/quality,q_85";break;case"medium":default:s="?x-oss-process=image/resize,m_lfit,w_600,h_600/quality,q_80";break;case"large":s="?x-oss-process=image/resize,m_lfit,w_1200,h_1200/quality,q_85"}return`${n}/${a}${s}`},m=e.computed((()=>s.posterData.imageHeight||200)),v=e.computed((()=>s.posterData.description&&s.posterData.description.length>50)),d=e.computed((()=>p(s.posterData.imageUrl,"medium"))),h=e.computed((()=>{var e;const t=(null==(e=s.posterData.author)?void 0:e.avatar)||"static/avatars/default.png";return p(t,"avatar")})),_=e.computed((()=>p("static/icons/location.png","icon"))),g=e.computed((()=>p("static/icons/view.png","icon"))),D=e.computed((()=>p("static/icons/share.png","icon"))),f=e.computed((()=>{const e=l.value?"static/icons/thumbs-up-filled.png":"static/icons/thumbs-up.png";return p(e,"icon")})),w=()=>{i.value=!1},x=()=>{i.value=!1,console.error("图片加载失败:",s.posterData.imageUrl)},b=()=>{r.value=!0},q=()=>{r.value=!1},k=()=>{o("view",s.posterData),e.index.vibrateShort({type:"light"})},y=()=>{u.value=!u.value},z=()=>{l.value||(l.value=!0,c.value=!0,o("like",s.posterData),e.index.vibrateShort({type:"medium"}),setTimeout((()=>{c.value=!1}),1e3))},T=()=>{o("share",s.posterData),e.index.showActionSheet({itemList:["分享到微信","分享到朋友圈","复制链接"],success:t=>{const a=["微信","朋友圈","复制链接"][t.tapIndex];e.index.showToast({title:`已${a}`,icon:"success",duration:1500})}})},S=e=>e?e>=1e4?(e/1e4).toFixed(1)+"w":e>=1e3?(e/1e3).toFixed(1)+"k":e.toString():"0";return e.onMounted((()=>{const e=300*Math.random();setTimeout((()=>{i.value=!1}),e)})),(a,s)=>{var o;return e.e({a:d.value,b:e.o(w),c:e.o(x),d:m.value+"rpx",e:i.value},(i.value,{}),{f:t.posterData.location},t.posterData.location?{g:_.value,h:e.t(t.posterData.location)}:{},{i:h.value,j:e.t((null==(o=t.posterData.author)?void 0:o.name)||"匿名用户"),k:e.t(t.posterData.publishTime||"刚刚"),l:e.t(t.posterData.description),m:u.value?1:"",n:v.value},v.value?{o:e.t(u.value?"收起":"全文"),p:e.o(y)}:{},{q:g.value,r:e.t(S(t.posterData.views)),s:f.value,t:e.t(S(t.posterData.likes)),v:c.value},(c.value,{}),{w:l.value?1:"",x:e.o(z),y:D.value,z:e.o(T),A:e.o(k),B:r.value?1:"",C:e.o(b),D:e.o(q)})}}},a=e._export_sfc(t,[["__scopeId","data-v-37203e9e"]]);wx.createComponent(a);
