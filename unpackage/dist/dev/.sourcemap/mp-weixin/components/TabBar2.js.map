{"version":3,"file":"TabBar2.js","sources":["components/TabBar.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovc2l0cOmhueebri9taW5pcHJvZ3JhbS9iaXJkLWZyb250ZW5kL2NvbXBvbmVudHMvVGFiQmFyLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"tab-bar\">\n    <view \n      v-for=\"(item, index) in tabList\" \n      :key=\"index\"\n      class=\"tab-item\"\n      :class=\"{ active: currentPath === item.pagePath }\"\n      @click=\"switchTab(item.pagePath)\"\n    >\n      <!-- 使用字体图标作为后备方案 -->\n      <view class=\"tab-icon-container\">\n        <image \n          v-if=\"!item.iconError\"\n          :src=\"getTabIconUrl(item, currentPath === item.pagePath)\" \n          class=\"tab-icon\"\n          @error=\"onIconError(item)\"\n          @load=\"onIconLoad(item)\"\n        />\n        <!-- 图标加载失败时显示的后备字体图标 -->\n        <text \n          v-else\n          class=\"tab-icon-fallback\"\n          :class=\"{ active: currentPath === item.pagePath }\"\n        >\n          {{ item.fallbackIcon }}\n        </text>\n      </view>\n      <text class=\"tab-text\">{{ item.text }}</text>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, reactive } from 'vue';\n\n// ========== 响应式数据 ==========\nconst currentPath = ref('/pages/HomePage/HomePage');\n\n// OSS配置\nconst ossConfig = {\n  baseUrl: 'https://birdfront-oss.oss-cn-shanghai.aliyuncs.com'\n};\n\n// ========== OSS工具方法 ==========\n/**\n * 获取OSS图片URL\n * @param {string} filename - 文件名\n * @param {string} size - 尺寸类型\n * @returns {string} 完整的OSS URL\n */\nconst getOSSUrl = (filename, size = 'icon') => {\n  if (!filename) return '';\n  \n  // 确保文件名不以斜杠开头\n  const cleanFilename = filename.startsWith('/') ? filename.slice(1) : filename;\n  \n  // 根据尺寸类型设置不同的处理参数\n  let params = '';\n  switch(size) {\n    case 'icon':\n      params = '?x-oss-process=image/resize,m_lfit,w_48,h_48/quality,q_90';\n      break;\n    case 'small-icon':\n      params = '?x-oss-process=image/resize,m_lfit,w_32,h_32/quality,q_90';\n      break;\n    default:\n      params = '?x-oss-process=image/resize,m_lfit,w_48,h_48/quality,q_90';\n  }\n  \n  return `${ossConfig.baseUrl}/${cleanFilename}${params}`;\n};\n\n// ========== 标签配置 ==========\nconst tabList = reactive([\n  {\n    pagePath: '/pages/HomePage/HomePage',\n    text: '首页',\n    iconPath: 'static/icons/home.png',\n    selectedIconPath: 'static/icons/home-active.png',\n    fallbackIcon: '🏠', // 后备字体图标\n    iconError: false // 图标是否加载失败\n  },\n  {\n    pagePath: '/pages/MapPage/MapPage',\n    text: '地图',\n    iconPath: 'static/icons/map.png',\n    selectedIconPath: 'static/icons/map-active.png',\n    fallbackIcon: '🗺️',\n    iconError: false\n  },\n  {\n    pagePath: '/pages/UploadPage/UploadPage',\n    text: '上传',\n    iconPath: 'static/icons/upload.png',\n    selectedIconPath: 'static/icons/upload-active.png',\n    fallbackIcon: '📤',\n    iconError: false\n  },\n  {\n    pagePath: '/pages/ProfilePage/ProfilePage',\n    text: '我的',\n    iconPath: 'static/icons/profile.png',\n    selectedIconPath: 'static/icons/profile-active.png',\n    fallbackIcon: '👤',\n    iconError: false\n  }\n]);\n\n// ========== 计算属性和方法 ==========\n\n/**\n * 获取标签图标的URL，优先使用本地路径作为后备\n * @param {Object} item - 标签项对象\n * @param {Boolean} isActive - 是否为激活状态\n * @returns {string} 图标的URL\n */\nconst getTabIconUrl = (item, isActive) => {\n  const iconPath = isActive ? item.selectedIconPath : item.iconPath;\n  \n  // 优先尝试本地路径\n  // const localPath = `/${iconPath}`;\n  \n  // 如果需要使用OSS，可以取消下面的注释\n  return getOSSUrl(iconPath, 'icon');\n  \n  // return localPath;\n};\n\n// ========== 事件处理函数 ==========\n\n/**\n * 切换标签页\n * @param {string} path - 页面路径\n */\nconst switchTab = (path) => {\n  currentPath.value = path;\n  \n  // 添加触觉反馈\n  try {\n    uni.vibrateShort({\n      type: 'light'\n    });\n  } catch (error) {\n    console.warn('触觉反馈不支持:', error);\n  }\n  \n  // 跳转页面\n  uni.switchTab({\n    url: path,\n    success: () => {\n      console.log('切换到:', path);\n    },\n    fail: (error) => {\n      console.error('页面跳转失败:', error);\n      // 可以尝试使用 navigateTo 作为降级方案\n      uni.navigateTo({\n        url: path,\n        fail: (navError) => {\n          console.error('导航失败:', navError);\n          uni.showToast({\n            title: '页面跳转失败',\n            icon: 'none'\n          });\n        }\n      });\n    }\n  });\n};\n\n/**\n * 图标加载失败处理\n * @param {Object} item - 标签项对象\n */\nconst onIconError = (item) => {\n  console.warn('标签栏图标加载失败:', item.text);\n  item.iconError = true; // 设置图标加载失败标志\n};\n\n/**\n * 图标加载成功处理\n * @param {Object} item - 标签项对象\n */\nconst onIconLoad = (item) => {\n  console.log('标签栏图标加载成功:', item.text);\n  item.iconError = false; // 重置图标加载失败标志\n};\n\n/**\n * 初始化当前页面路径\n * 可以通过uni.getCurrentPages()获取当前页面路径\n */\nconst initCurrentPath = () => {\n  try {\n    // 在uni-app中获取当前页面栈\n    const pages = getCurrentPages();\n    if (pages && pages.length > 0) {\n      const currentPage = pages[pages.length - 1];\n      const route = currentPage.route;\n      \n      // 根据路由匹配标签\n      const matchedTab = tabList.find(tab => {\n        const tabRoute = tab.pagePath.replace(/^\\//, '');\n        return route === tabRoute;\n      });\n      \n      if (matchedTab) {\n        currentPath.value = matchedTab.pagePath;\n      }\n    }\n  } catch (error) {\n    console.warn('获取当前页面路径失败:', error);\n    // 设置默认路径\n    currentPath.value = '/pages/HomePage/HomePage';\n  }\n};\n\n// ========== 生命周期 ==========\nonMounted(() => {\n  initCurrentPath();\n  \n  // 可以在这里添加页面变化监听（如果需要的话）\n  console.log('TabBar组件已挂载，当前路径:', currentPath.value);\n});\n</script>\n\n<style scoped>\n.tab-bar {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  height: 100rpx; /* 使用rpx单位 */\n  display: flex;\n  background-color: #ffffff;\n  box-shadow: 0 -4rpx 16rpx rgba(0, 0, 0, 0.1);\n  border-top: 1rpx solid rgba(0, 0, 0, 0.05);\n  z-index: 1000;\n  transition: all 0.3s ease;\n}\n\n.tab-item {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 8rpx 0;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  position: relative;\n  cursor: pointer;\n}\n\n.tab-item:active {\n  transform: scale(0.95);\n  background-color: rgba(46, 163, 183, 0.05);\n}\n\n.tab-item::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 0;\n  height: 4rpx;\n  background: #2EA3B7;\n  border-radius: 2rpx;\n  transition: width 0.3s ease;\n}\n\n.tab-item.active::before {\n  width: 40rpx;\n}\n\n.tab-icon-container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 48rpx;\n  height: 48rpx;\n  margin-bottom: 4rpx;\n}\n\n.tab-icon {\n  width: 48rpx;\n  height: 48rpx;\n  transition: all 0.3s ease;\n  opacity: 0.7;\n}\n\n.tab-item.active .tab-icon {\n  opacity: 1;\n  transform: scale(1.1);\n}\n\n/* 后备字体图标样式 */\n.tab-icon-fallback {\n  font-size: 40rpx;\n  line-height: 48rpx;\n  transition: all 0.3s ease;\n  opacity: 0.7;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.tab-icon-fallback.active {\n  opacity: 1;\n  transform: scale(1.1);\n}\n\n.tab-text {\n  font-size: 20rpx;\n  color: #666;\n  font-weight: 500;\n  transition: all 0.3s ease;\n  line-height: 1.2;\n  text-align: center;\n}\n\n.tab-item.active .tab-text {\n  color: #2EA3B7;\n  font-weight: 600;\n  transform: scale(1.05);\n}\n\n/* 悬停效果（主要针对H5端） */\n@media (hover: hover) {\n  .tab-item:hover {\n    background-color: rgba(46, 163, 183, 0.03);\n  }\n  \n  .tab-item:hover .tab-icon,\n  .tab-item:hover .tab-icon-fallback {\n    opacity: 0.9;\n    transform: translateY(-2rpx);\n  }\n  \n  .tab-item:hover .tab-text {\n    color: #2EA3B7;\n  }\n}\n\n/* 响应式适配 */\n@media screen and (max-width: 750rpx) {\n  .tab-bar {\n    height: 96rpx;\n  }\n  \n  .tab-icon-container {\n    width: 44rpx;\n    height: 44rpx;\n  }\n  \n  .tab-icon {\n    width: 44rpx;\n    height: 44rpx;\n  }\n  \n  .tab-icon-fallback {\n    font-size: 36rpx;\n    line-height: 44rpx;\n  }\n  \n  .tab-text {\n    font-size: 18rpx;\n  }\n}\n\n/* 适配iphoneX等带有安全区域的设备 */\n@supports (bottom: env(safe-area-inset-bottom)) {\n  .tab-bar {\n    padding-bottom: env(safe-area-inset-bottom);\n    height: calc(100rpx + env(safe-area-inset-bottom));\n  }\n}\n\n/* 暗色模式适配 */\n@media (prefers-color-scheme: dark) {\n  .tab-bar {\n    background-color: #1a1a1a;\n    border-top-color: rgba(255, 255, 255, 0.1);\n  }\n  \n  .tab-text {\n    color: #999;\n  }\n  \n  .tab-item.active .tab-text {\n    color: #4dd0e1;\n  }\n  \n  .tab-item::before {\n    background: #4dd0e1;\n  }\n}\n\n/* 优化动画性能 */\n.tab-item,\n.tab-icon,\n.tab-icon-fallback,\n.tab-text {\n  will-change: transform, opacity;\n}\n\n/* 防止文本选中 */\n.tab-text {\n  user-select: none;\n  -webkit-user-select: none;\n}\n</style>","import Component from 'D:/sitp项目/miniprogram/bird-frontend/components/TabBar.vue'\nwx.createComponent(Component)"],"names":["ref","reactive","uni","onMounted"],"mappings":"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"}