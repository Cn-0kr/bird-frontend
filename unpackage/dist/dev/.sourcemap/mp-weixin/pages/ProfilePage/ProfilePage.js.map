{"version":3,"file":"ProfilePage.js","sources":["pages/ProfilePage/ProfilePage.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvUHJvZmlsZVBhZ2UvUHJvZmlsZVBhZ2UudnVl"],"sourcesContent":["<template>\n  <view class=\"profile-container\">\n    <!-- 顶部个人信息区 -->\n    <view class=\"profile-header\">\n      <view class=\"header-content\">\n        <view class=\"avatar-section\" @click=\"handleAvatarClick\">\n          <image \n            :src=\"userInfo.avatar || '/static/default-avatar.png'\" \n            class=\"avatar\"\n            mode=\"aspectFill\"\n          ></image>\n          <view class=\"edit-hint\">点击修改</view>\n        </view>\n        \n        <view class=\"user-info\">\n          <view class=\"nickname-row\">\n            <text class=\"nickname\">{{ userInfo.nickname }}</text>\n            <view class=\"edit-btn\" @click=\"handleEditProfile\">\n              <image src=\"/static/icons/edit.png\" class=\"edit-icon\"></image>\n            </view>\n          </view>\n          \n          <view class=\"bio\" @click=\"handleEditBio\">\n            {{ userInfo.bio || '点击添加个人介绍...' }}\n          </view>\n\n          <!-- 统计信息 -->\n          <view class=\"stats\">\n            <view class=\"stat-item\">\n              <text class=\"stat-num\">{{ userInfo.postsCount }}</text>\n              <text class=\"stat-label\">发布</text>\n            </view>\n            <view class=\"stat-item\">\n              <text class=\"stat-num\">{{ userInfo.likesCount }}</text>\n              <text class=\"stat-label\">获赞</text>\n            </view>\n            <view class=\"stat-item\">\n              <text class=\"stat-num\">{{ userInfo.level }}</text>\n              <text class=\"stat-label\">等级</text>\n            </view>\n          </view>\n        </view>\n      </view>\n\n      <!-- 成就展示 -->\n      <scroll-view scroll-x class=\"achievements\" :show-scrollbar=\"false\">\n        <view \n          v-for=\"achievement in achievements\" \n          :key=\"achievement.id\" \n          class=\"achievement-item\"\n        >\n          <image :src=\"achievement.icon\" class=\"achievement-icon\"></image>\n          <text class=\"achievement-name\">{{ achievement.name }}</text>\n        </view>\n      </scroll-view>\n    </view>\n\n    <!-- 内容分类标签页 -->\n    <view class=\"content-tabs\">\n      <view \n        class=\"tab-item\" \n        :class=\"{ active: activeTab === 'posts' }\"\n        @click=\"switchTab('posts')\"\n      >\n        历史发布\n      </view>\n      <view \n        class=\"tab-item\"\n        :class=\"{ active: activeTab === 'likes' }\"\n        @click=\"switchTab('likes')\"\n      >\n        我的点赞\n      </view>\n      <view \n        class=\"tab-item\"\n        :class=\"{ active: activeTab === 'records' }\"\n        @click=\"switchTab('records')\"\n      >\n        识别记录\n      </view>\n    </view>\n\n    <!-- 瀑布流内容区域 -->\n    <view class=\"content-area\">\n      <view v-if=\"isLoading\" class=\"loading\">加载中...</view>\n      <view v-else-if=\"currentContent.length === 0\" class=\"empty-hint\">\n        {{ activeTab === 'posts' \n            ? '还没有发布过内容~' \n            : activeTab === 'likes' \n              ? '还没有点赞过内容~'\n              : '还没有识别过哦~' }}\n      </view>\n      <view v-else class=\"waterfall\">\n        <view class=\"column\">\n          <home-poster\n            v-for=\"poster in leftColumn\"\n            :key=\"poster.id\"\n            :poster-data=\"poster\"\n          ></home-poster>\n        </view>\n        <view class=\"column\">\n          <home-poster\n            v-for=\"poster in rightColumn\"\n            :key=\"poster.id\"\n            :poster-data=\"poster\"\n          ></home-poster>\n        </view>\n      </view>\n    </view>\n\t\n    <!-- 添加底部导航栏 -->\n    <tab-bar></tab-bar>\n  </view>\n</template>\n\n<script>\nimport TabBar from '@/components/tabbar.vue';\nimport HomePoster from '../../components/homeposter.vue';\nimport { UserService } from '@/api/services/user';\n\nconst userService = new UserService();\n\nexport default {\n  components: {\n    HomePoster,\n    TabBar\n  },\n\n  data() {\r\n    return {\r\n      isLoading: false,\r\n      activeTab: 'posts',\r\n      userInfo: {\r\n        avatar: '/static/default-avatar.png',\r\n        nickname: '鸟类爱好者',\r\n        bio: '',  // 添加默认提示\r\n        postsCount: 0,\r\n        likesCount: 0, \r\n        level: 1\r\n      },\r\n      achievements: [\r\n        {\r\n          id: 1,\r\n          name: '初级观鸟员',\r\n          icon: '/static/icons/achievements/beginner.png'\r\n        },\r\n        {\r\n          id: 2, \r\n          name: '摄影新手',\r\n          icon: '/static/icons/achievements/photographer.png'\r\n        }\r\n      ],\r\n      posts: [],\r\n      likes: [],\r\n      records: [],\r\n      leftColumn: [],\r\n      rightColumn: []\r\n    }\r\n  },\n\n  computed: {\n    currentContent() {\n      switch(this.activeTab) {\n        case 'posts':\n          return this.posts;\n        case 'likes':\n          return this.likes;\n        case 'records':\n          return this.records;\n        default:\n          return [];\n      }\n    }\n  },\n\n  async onLoad() {\n    await this.loadUserInfo();\n    this.loadContent();\n  },\n\n  methods: {\n\tasync loadUserInfo() {\n\t  try {\n\t\t// 获取个人介绍\n\t\tconst intro = await userService.getIntro();\r\n\t\t// console.log(intro);\n\t\tthis.userInfo.bio = intro || '点击添加个人介绍...';\n\t  } catch (error) {\n\t\tconsole.error('Failed to load user info:', error);\n\t\tuni.showToast({\n\t\t  title: '加载个人信息失败',\n\t\t  icon: 'none'\n\t\t});\n\t  }\n\t},\n\n    handleAvatarClick() {\n      uni.chooseImage({\n        count: 1,\n        success: (res) => {\n          this.userInfo.avatar = res.tempFilePaths[0];\n        }\n      });\n    },\n\n    handleEditProfile() {\n      uni.navigateTo({\n        url: '/pages/EditProfile/EditProfile'\n      });\n    },\n\n    handleEditBio() {\n      uni.showModal({\n        title: '编辑个人介绍',\n        editable: true,\n        content: this.userInfo.bio,\n        success: (res) => {\n          if (res.confirm) {\n            this.updateBio(res.content);\n          }\n        }\n      });\n    },\n\n    async updateBio(newBio) {\n      try {\n        // 这里可以添加更新个人介绍的API调用\n        // await userService.updateIntro(newBio);\n        this.userInfo.bio = newBio;\n        uni.showToast({\n          title: '更新成功',\n          icon: 'success'\n        });\n      } catch (error) {\n        console.error('Failed to update bio:', error);\n        uni.showToast({\n          title: '更新失败',\n          icon: 'none'\n        });\n      }\n    },\n\n    switchTab(tab) {\n      if (this.activeTab !== tab) {\n        this.activeTab = tab;\n        this.loadContent();\n      }\n    },\n\n    async loadContent() {\n      this.isLoading = true;\n      try {\n        setTimeout(() => {\n          let data;\n          \n          switch(this.activeTab) {\n            case 'posts':\n              data = [\n                {\n                  id: 1,\n                  imageUrl: '/static/posts/bird1.jpg',\n                  imageHeight: 200,\n                  description: '今天拍到的小鸟',\n                  views: 1234,\n                  likes: 88\n                }\n              ];\n              this.posts = data;\n              break;\n            case 'likes':\n              data = [\n                {\n                  id: 2,\n                  imageUrl: '/static/posts/bird2.jpg',\n                  imageHeight: 280,\n                  description: '好漂亮的鸟儿！',\n                  views: 2567,\n                  likes: 189\n                }\n              ];\n              this.likes = data;\n              break;\n            case 'records':\n              data = [\n                {\n                  id: 3,\n                  imageUrl: '/static/recognition/bird1.jpg',\n                  imageHeight: 240,\n                  description: '识别结果：红头长尾山雀',\n                  accuracy: '98%',\n                  date: '2024-03-20'\n                },\n                {\n                  id: 5,\n                  imageUrl: '/static/recognition/bird2.jpg',\n                  imageHeight: 220,\n                  description: '识别结果：白头硬尾鹎',\n                  accuracy: '97%',\n                  date: '2024-03-18'\n                }\n              ];\n              this.records = data;\n              break;\n          }\n          \n          this.distributeContent();\n          this.isLoading = false;\n        }, 500);\n      } catch (error) {\n        console.error('Load content error:', error);\n        this.isLoading = false;\n        uni.showToast({\n          title: '加载失败',\n          icon: 'none'\n        });\n      }\n    },\n\n    distributeContent() {\n      this.leftColumn = [];\n      this.rightColumn = [];\n      \n      this.currentContent.forEach((item, index) => {\n        if (index % 2 === 0) {\n          this.leftColumn.push(item);\n        } else {\n          this.rightColumn.push(item);\n        }\n      });\n    }\n  }\n}\n</script>\n\n<style scoped>\n.profile-container {\n  min-height: 100vh;\n  background-color: #FFF9E9;\n}\n\n.profile-header {\n  padding: 20px 16px;\n  background: #FFFFFF;\n  border-radius: 0 0 16px 16px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n}\n\n.header-content {\n  display: flex;\n  align-items: flex-start;\n}\n\n.avatar-section {\n  position: relative;\n  margin-right: 16px;\n}\n\n.avatar {\n  width: 80px;\n  height: 80px;\n  border-radius: 50%;\n  border: 2px solid #2EA3B7;\n}\n\n.edit-hint {\n  position: absolute;\n  bottom: -4px;\n  left: 50%;\n  transform: translateX(-50%);\n  background: rgba(46, 163, 183, 0.8);\n  color: white;\n  font-size: 10px;\n  padding: 2px 6px;\n  border-radius: 8px;\n}\n\n.user-info {\n  flex: 1;\n}\n\n.nickname-row {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.nickname {\n  font-size: 20px;\n  font-weight: bold;\n  color: #1D1D2B;\n  margin-right: 8px;\n}\n\n.edit-icon {\n  width: 16px;\n  height: 16px;\n}\n\n.bio {\n  font-size: 14px;\n  color: #666;\n  margin-bottom: 12px;\n  line-height: 1.4;\n}\n\n.stats {\n  display: flex;\n  margin-top: 12px;\n}\n\n.stat-item {\n  margin-right: 24px;\n  text-align: center;\n}\n\n.stat-num {\n  font-size: 18px;\n  font-weight: bold;\n  color: #1D1D2B;\n  display: block;\n}\n\n.stat-label {\n  font-size: 12px;\n  color: #666;\n}\n\n.achievements {\n  margin-top: 16px;\n  white-space: nowrap;\n}\n\n.achievement-item {\n  display: inline-flex;\n  flex-direction: column;\n  align-items: center;\n  margin-right: 16px;\n}\n\n.achievement-icon {\n  width: 40px;\n  height: 40px;\n  margin-bottom: 4px;\n}\n\n.achievement-name {\n  font-size: 12px;\n  color: #666;\n}\n\n.content-tabs {\n  display: flex;\n  background: #FFFFFF;\n  padding: 12px 16px;\n  margin: 12px 0;\n}\n\n.tab-item {\n  flex: 1;\n  text-align: center;\n  padding: 8px 0;\n  font-size: 14px;\n  color: #666;\n  position: relative;\n}\n\n.tab-item.active {\n  color: #2EA3B7;\n  font-weight: bold;\n}\n\n.tab-item.active::after {\n  content: '';\n  position: absolute;\n  bottom: -8px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 20px;\n  height: 2px;\n  background: #2EA3B7;\n  border-radius: 1px;\n}\n\n.content-area {\n  padding: 12px;\n}\n\n.loading, .empty-hint {\n  text-align: center;\n  padding: 40px 0;\n  color: #999;\n}\n\n.waterfall {\n  display: flex;\n  justify-content: space-between;\n}\n\n.column {\n  width: 48%;\n}\n\n.achievement-item:nth-child(1) .achievement-name {\n  font-family: \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n  font-size: 13px;\n  font-weight: 600;\n  background: linear-gradient(45deg, #4A90E2, #9B59B6);\n  background-clip: text;\n  -webkit-background-clip: text;\n  color: transparent;\n  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);\n  letter-spacing: 1px;\n}\n\n.achievement-item:nth-child(2) .achievement-name {\n  font-family: \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n  font-size: 13px;\n  font-weight: 600;\n  background: linear-gradient(45deg, #E74C3C, #F1C40F);\n  background-clip: text;\n  -webkit-background-clip: text;\n  color: transparent;\n  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);\n  letter-spacing: 1px;\n}\n</style>","import MiniProgramPage from 'D:/sitp项目/miniprogram/bird-frontend/pages/ProfilePage/ProfilePage.vue'\nwx.createPage(MiniProgramPage)"],"names":["UserService","uni"],"mappings":"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"}